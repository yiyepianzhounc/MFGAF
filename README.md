# MFGAF: Multi-faceted Granular Analysis Framework for LLM-Generated Text Detection

This repository contains the official implementation for the paper: **"MFGAF: Multi-faceted Granular Analysis Framework for LLM-Generated Text Detection"**.

Our framework introduces a novel zero-shot approach for detecting LLM-generated text by leveraging dual perspectives (Rewriting and Completion) and a multi-granular textual analysis across semantic, syntactic, lexical, and reasoning dimensions.

<!-- You can add your framework diagram here -->
<!-- ![Framework Overview](framework_diagram.png) -->

## 1. Dataset

This study utilizes the public benchmark dataset released with the paper:

> **Raidar: GeneRative AI Detection viA Rewriting**
>
> Chengzhi Mao, Carl Vondrick, Hao Wang, and Junfeng Yang. In *ICLR 2024*.

We sincerely thank the authors of Raidar for making their data publicly available.

#### Data Collection and Annotation

As we use an existing dataset, all details regarding data collection and annotation can be found in the original Raidar paper. The dataset covers six domains: News, Creative Writing, Student Essays, Code, Reviews, and Abstracts. The texts were generated using models like GPT-3.5-turbo and GPT-4.

#### Data Usage

To use the dataset for this project, please follow these steps:
1.  Visit the official Raidar repository: [https://github.com/cvlab-columbia/RaidarLLMDetect](https://github.com/cvlab-columbia/RaidarLLMDetect)
2.  Follow their instructions to download the dataset.
3.  Place the downloaded data files into the directory of this project.

#### Data Sample

A typical data entry from the dataset is a JSON object containing a question and various corresponding human- and machine-generated texts. The structure of our project's preprocessed data is as follows:

```json
{
  "question": "Where can I lookup accurate current exchange rates for consumers?",
  "human_answers": "Current and past FX rates are available on Visa's website...",
  "chatgpt_answers": "There are several websites and resources that provide accurate and current exchange rates...",
  "human_answers_masked": "[MASK] Note that it may vary by country...",
  "chatgpt_answers_masked": "[MASK] [MASK] You can typically find this information...",
  "human_answers_masked_fill": "You can lookup accurate current exchange rates for consumers on financial news websites...",
  "chatgpt_answers_masked_fill": "Here is the filled text:\n\nYou can typically find this information...",
  "human_answers_revised": "\n\nVisa's website provides both current and past FX rates...",
  "chatgpt_answers_revised": "\n\nConsumers have access to various websites and resources..."
}
```

### Field Descriptions (字段说明)

| Field Name (字段名)    | Description (描述)                                                                                                                |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| `question`             | The initial prompt or question. (初始的提示或问题)                                                                                 |
| `human_answers`        | The original answer written by a human. (由人类撰写的原始答案)                                                                     |
| `chatgpt_answers`      | The original answer generated by ChatGPT. (由ChatGPT生成的原始答案)                                                                |
| `*_masked`             | Texts with parts replaced by `[MASK]` tokens, used for the Completion Resonance Analysis. (部分内容被 `[MASK]` 替换的文本，用于补全一致性分析) |
| `*_masked_fill`        | The result of an LLM filling in the `[MASK]` tokens. (由LLM填充 `[MASK]` 后的结果)                                                  |
| `*_revised`            | Texts that have been rewritten by an LLM, used for the Rewriting Resonance Analysis. (被LLM重写后的文本，用于重写一致性分析)        |

**Note:** Our framework, MFGAF, primarily uses the `human_answers`, `chatgpt_answers`, and the corresponding `*_revised` (for RRA) and `*_masked` / `*_masked_fill` (for CRA) fields to perform its analysis.

---

## 2. How to Use Our Code
### Prerequisites

Clone this repository:

```bash
git clone https://github.com/yiyepianzhounc/MFGAF.git
cd MFGAF
```
Install the required dependencies:

```bash
pip install -r requirements.txt
```
### Running the Detection Logic

The core logic of our MFGAF framework is demonstrated in the `ours.ipynb` Jupyter Notebook.

## 3. Citation
If you use our framework MFGAF or find this work helpful in your research, please cite our paper.
Additionally, since our experiments rely on the Raidar dataset, we strongly recommend citing their original paper as well.
### To cite MFGAF
### To cite the Raidar dataset:
```bibtex
@inproceedings{mao2024raidar,
title={Raidar: geneRative {AI} Detection viA Rewriting},
author={Chengzhi Mao and Carl Vondrick and Hao Wang and Junfeng Yang},
booktitle={Proceedings of the 12th International Conference on Learning Representations},
year={2024},
url={https://openreview.net/forum?id=bQWE2UqXmf},
publisher = {http://OpenReview.net},
pages = {1--18},
volume={7},
}
```
## 4. Contact

For any questions regarding our paper or code, please feel free to open an issue in this repository or contact us at:

- **Jia Chen**: [chenjial@stu.scu.edu.cn](mailto:chenjial@stu.scu.edu.cn)  
- **Haizhou Wang**: [whzh.nc@scu.edu.cn](mailto:whzh.nc@scu.edu.cn)  


---

## 5. Ethical Considerations

- **PII**: The Raidar dataset used in this study has been processed by its original authors to remove personally identifiable information (PII).  
- **Authorization for Use**: As this is a public research dataset, users are expected to adhere to academic integrity and use it for research purposes only, in line with the terms set by the original authors.


